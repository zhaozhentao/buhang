(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-576f06a6"],{"0f81":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container"},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"所有分类",clearable:""},on:{change:e.fetchData},model:{value:e.listQuery.categoryId,callback:function(t){e.$set(e.listQuery,"categoryId",t)},expression:"listQuery.categoryId"}},e._l(e.categories,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"dragTable",attrs:{data:e.list,"element-loading-text":"Loading","row-key":"id",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{align:"center",label:"ID",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"货号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.goodsNumber)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"品名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.goodsName)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"克重"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.weight)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"幅宽"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.width)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"每公斤(米)"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.meterPerKilo)+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center",width:"400","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.addCard(n)}}},[e._v("\n          添加色卡样板\n        ")]),e._v(" "),r("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.show(n.id)}}},[e._v("\n          查看色卡样板\n        ")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.editCard(n)}}},[e._v("\n          编辑\n        ")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteRow(n)}}},[e._v("\n          删除\n        ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"排序",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("svg-icon",{staticClass:"drag-handler",attrs:{"icon-class":"drag"}})]}}])})],1),e._v(" "),r("el-dialog",{attrs:{title:"修改色卡",visible:e.editCardDialog},on:{"update:visible":function(t){e.editCardDialog=t}}},[r("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.cardForm,"label-position":"left","label-width":"150px"}},[r("el-form-item",{attrs:{label:"分类",prop:"name"}},[r("el-select",{staticClass:"filter-item",attrs:{placeholder:"暂无分类",clearable:""},model:{value:e.cardForm.categoryId,callback:function(t){e.$set(e.cardForm,"categoryId",t)},expression:"cardForm.categoryId"}},e._l(e.categories,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"货号",prop:"name"}},[r("el-input",{model:{value:e.cardForm.goodsNumber,callback:function(t){e.$set(e.cardForm,"goodsNumber",t)},expression:"cardForm.goodsNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"品名",prop:"name"}},[r("el-input",{model:{value:e.cardForm.goodsName,callback:function(t){e.$set(e.cardForm,"goodsName",t)},expression:"cardForm.goodsName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"克重(g)",prop:"name"}},[r("el-input",{model:{value:e.cardForm.weight,callback:function(t){e.$set(e.cardForm,"weight",t)},expression:"cardForm.weight"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"幅宽(cm)",prop:"name"}},[r("el-input",{attrs:{type:"number"},model:{value:e.cardForm.width,callback:function(t){e.$set(e.cardForm,"width",t)},expression:"cardForm.width"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"每公斤(米)",prop:"name"}},[r("el-input",{attrs:{type:"number"},model:{value:e.cardForm.meterPerKilo,callback:function(t){e.$set(e.cardForm,"meterPerKilo",t)},expression:"cardForm.meterPerKilo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"色卡封面",prop:"image"}},[r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{multiple:"",action:"/api/files","on-success":e.addEditCardImg,"on-remove":e.removeEditCardImg,"file-list":e.editFileList,"list-type":"picture"}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editCardDialog=!1}}},[e._v("\n        取消\n      ")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateCard()}}},[e._v("\n        确认\n      ")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"添加色卡样板",visible:e.addCardDialog},on:{"update:visible":function(t){e.addCardDialog=t}}},[r("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.cardForm,"label-position":"left","label-width":"150px"}},[r("el-form-item",{attrs:{label:"样板图片",prop:"image"}},[r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{multiple:"",action:"/api/files",limit:9,"on-success":e.onSuccess,"on-remove":e.onRemove,"file-list":e.fileList}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addCardDialog=!1}}},[e._v("\n        取消\n      ")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createCardItem()}}},[e._v("\n        确认\n      ")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"色卡样板",visible:e.showCardItems},on:{"update:visible":function(t){e.showCardItems=t}}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"dragSample",attrs:{"row-key":"id",data:e.cardItems,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{label:"样板图片"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-image",{staticClass:"cover",attrs:{"preview-src-list":e.previewSrcList[t.$index],src:t.row.image}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center",width:"100","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.deleteImage(n)}}},[e._v("\n            删除\n          ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"排序",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("svg-icon",{staticClass:"drag-handler",attrs:{"icon-class":"drag"}})]}}])})],1)],1)],1)},a=[],i=(r("28a5"),r("7514"),r("7f7f"),r("96cf"),r("3b8d")),o=r("2ef0"),s=r.n(o),l=r("aa47"),c=r("1696"),u=r("ad8f"),d=r("b775");function m(e){return Object(d["a"])({url:"/cardItems/".concat(e),method:"delete"})}function f(e){return Object(d["a"])({url:"/cardItems",method:"post",params:e})}function p(e){return Object(d["a"])({url:"/cardItems",method:"patch",data:e})}r("8d41");var h="@@wavesContext";function g(e,t){function r(r){var n=Object.assign({},t.value),a=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),i=a.ele;if(i){i.style.position="relative",i.style.overflow="hidden";var o=i.getBoundingClientRect(),s=i.querySelector(".waves-ripple");switch(s?s.className="waves-ripple":(s=document.createElement("span"),s.className="waves-ripple",s.style.height=s.style.width=Math.max(o.width,o.height)+"px",i.appendChild(s)),a.type){case"center":s.style.top=o.height/2-s.offsetHeight/2+"px",s.style.left=o.width/2-s.offsetWidth/2+"px";break;default:s.style.top=(r.pageY-o.top-s.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",s.style.left=(r.pageX-o.left-s.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return s.style.backgroundColor=a.color,s.className="waves-ripple z-active",!1}}return e[h]?e[h].removeHandle=r:e[h]={removeHandle:r},r}var v={bind:function(e,t){e.addEventListener("click",g(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[h].removeHandle,!1),e.addEventListener("click",g(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[h].removeHandle,!1),e[h]=null,delete e[h]}},b=function(e){e.directive("waves",v)};window.Vue&&(window.waves=v,Vue.use(b)),v.install=b;var w=v,y={name:"DragTable",directives:{waves:w},data:function(){return{sortable:null,sortable2:null,categories:[],editFileList:[],listLoading:!0,showCardItems:!1,editCardDialog:!1,addCardDialog:!1,listQuery:{categoryId:null},list:null,rules:{},fileList:[],cardForm:{},cardItems:[],addingCardRowId:null,showingCardItemsCardId:null,previewSrcList:null}},created:function(){this.init()},methods:{show:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["c"])(t);case 2:r=e.sent,this.showingCardItemsCardId=t,this.cardItems=r.data,this.showCardItems=!0,this.previewSrcList=s.a.map(this.cardItems,(function(e){return e.image})),this.previewSrcList=s.a.map(this.previewSrcList,(function(e,t){return s.a.concat(s.a.slice(n.previewSrcList,t),s.a.slice(n.previewSrcList,0,t))})),this.$nextTick((function(){n.initDialogSort()}));case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),initDialogSort:function(){var e=this,t=this.$refs.dragSample.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable2=l["a"].create(t,{ghostClass:"sortable-ghost",setData:function(e){e.setData("Text","")},onEnd:function(t){var r=e.cardItems.splice(t.oldIndex,1)[0];e.cardItems.splice(t.newIndex,0,r),e.saveItemSort(s.a.map(e.cardItems,(function(e){return e.id})))}})},onSuccess:function(e){var t={name:e,response:e};this.fileList=s.a.concat(this.fileList,t)},onRemove:function(e){s.a.remove(this.fileList,(function(t){return t.name===e.name}))},addEditCardImg:function(e){this.editFileList=[{name:e,response:e,url:"".concat(location.protocol,"//").concat(location.host,"/api/files/").concat(e)}]},removeEditCardImg:function(e){this.editFileList=[]},addCard:function(e){this.fileList=[],this.addingCardRowId=e.id,this.addCardDialog=!0},editCard:function(e){this.editCardDialog=!0,this.cardForm=s.a.cloneDeep(e),s.a.isEmpty(s.a.find(this.categories,{id:e.categoryId}))&&(this.cardForm.categoryId="");var t=s.a.split(e.img,"files/")[1];this.editFileList=[{name:t,response:t,url:e.img}]},init:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.next=3,Object(u["d"])();case 3:t=e.sent,this.categories=t.data,this.listLoading=!1,this.fetchData(),this.$nextTick((function(){r.setSort()}));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),createCardItem:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=s.a.join(s.a.map(this.fileList,(function(e){return e.name})),","),e.next=3,f({cardId:this.addingCardRowId,image:t});case 3:this.$message.success("添加成功"),this.addCardDialog=!1;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),updateCard:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.cardForm.img=this.editFileList[0].name,e.next=3,Object(c["f"])(this.cardForm);case 3:this.$message.success("修改成功"),this.editCardDialog=!1,this.fetchData();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteRow:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("确认删除?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});case 2:return e.next=4,Object(c["b"])(t.id);case 4:this.$message.success("删除成功"),this.fetchData();case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),fetchData:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,t={},s.a.isNumber(this.listQuery.categoryId)&&(t.categoryId=this.listQuery.categoryId),e.next=5,Object(c["d"])(t);case 5:r=e.sent,this.list=r.data,this.listLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),saveSort:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["e"])({sort:t});case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),saveItemSort:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p({sort:t});case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),setSort:function(){var e=this,t=this.$refs.dragTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=l["a"].create(t,{ghostClass:"sortable-ghost",setData:function(e){e.setData("Text","")},onEnd:function(t){var r=e.list.splice(t.oldIndex,1)[0];e.list.splice(t.newIndex,0,r),e.saveSort(s.a.map(e.list,(function(e){return e.id})))}})},deleteImage:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("确认删除?","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});case 2:return e.next=4,m(t.id);case 4:this.$message.success("删除成功"),this.show(this.showingCardItemsCardId);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},_=y,x=(r("5380"),r("2877")),C=Object(x["a"])(_,n,a,!1,null,"3f89a780",null);t["default"]=C.exports},1696:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"f",(function(){return l})),r.d(t,"e",(function(){return c}));var n=r("b775");function a(e){return Object(n["a"])({url:"/cards",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/cards/".concat(e,"/card_items"),method:"get"})}function o(e){return Object(n["a"])({url:"/cards",method:"post",params:e})}function s(e){return Object(n["a"])({url:"/cards/".concat(e),method:"delete"})}function l(e){return Object(n["a"])({url:"/cards/".concat(e.id),method:"patch",params:e})}function c(e){return Object(n["a"])({url:"/cards",method:"patch",data:e})}},5380:function(e,t,r){"use strict";var n=r("e059"),a=r.n(n);a.a},"8d41":function(e,t,r){},ad8f:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("b775");function a(e){return Object(n["a"])({url:"/categories",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/categories",method:"post",params:e})}function o(e){return Object(n["a"])({url:"/categories/".concat(e),method:"delete"})}function s(e){return Object(n["a"])({url:"/categories/".concat(e.id),method:"patch",params:e})}},e059:function(e,t,r){}}]);